<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC
"-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping package="model">

	<class name="Sitio" TABLE="SITIO">
		<id name="oId" column="ID_SITIO">
			<generator class="native" />
		</id>
		<list name="usuarios" inverse="true" cascade="all">
			<key column="ID_SITIO" />
			<one-to-many class="Usuario" />
		</list>
		<many-to-one name="catalogo" column="ID_CATALOGO" unique="true"
			not-null="true" cascade="all" />
	</class>

	<class name="Catalogo" TABLE="CATALOGO">
		<id name="oId" column="ID_CATALOGO">
			<generator class="native" />
		</id>
		<set name="contenidos" inverse="true" cascade="all">
			<key column="ID_CATALOGO" />
			<one-to-many class="Contenido" />
		</set>
	</class>

	<Class name="Sesion" TABLE="SESION">
		<id name="oId" column="ID_SESION">
			<generator class="native" />
		</id>
		<property name="fecha" type="date" />
		<many-to-one name="reproduccion" column="ID_REPRODUCCION"
			unique="true" not-null="true" cascade="all" />
	</Class>

	<Class name="Usuario" TABLE="USUARIO">
		<id name="oId" column="ID_USUARIO">
			<generator class="native" />
		</id>
		<property name="email" type="string" />
		<property name="fechaNacimiento" type="date" />
		<many-to-one name="gestor" column="ID_GESTOR" unique="true"
			not-null="true" cascade="all" />
		<many-to-one name="suscripcion" column="ID_SUSCRIPCION"
			unique="true" not-null="true" cascade="all" />
	</Class>

	<Class name="Suscripcion" TABLE="SUSCRIPCION">
		<id name="oId" column="ID_SUSCRIPCION">
			<generator class="native" />
		</id>
		<many-to-one name="categoria" column="ID_CATEGORIA"
			unique="true" not-null="true" cascade="all" />
		<property name="fechaSuscripcion" type="date" />
	</Class>

	<Class name="GestorDeContenidos" TABLE="GESTOR">
		<id name="oId" column="ID_GESTOR">
			<generator class="native" />
		</id>
		<many-to-one name="catalogo" column="ID_CATALOGO" unique="true"
			not-null="true" cascade="all" />
		<many-to-one name="usuario" column="ID_USUARIO" unique="true"
			not-null="true" cascade="all" />
		<list name="reproducciones" cascade="all">
			<key column="ID_GESTOR" not-null="true" />
			<one-to-many class="Reproduccion" />
		</list>
	</Class>

	<Class name="Reproduccion" TABLE="REPRODUCCION">
		<id name="oId" column="ID_REPRODUCCION">
			<generator class="native" />
		</id>
		<property name="fecha" type="date" />
		<property name="tiempo" type="long" />
		<many-to-one name="reproducible" column="ID_REPRODUCIBLE"
			unique="true" not-null="true" cascade="all" />
	</Class>

	<Class name="Categoria" table="CATEGORIA">
		<id name="oId" column="ID_CATEGORIA">
			<generator class="native" />
		</id>
		<property name="fecha" type="date" />
		<joined-subclass name="CategoriaInvitado" table="CATEGORIA_INVITADO">
			<key column="ID_CATEGORIA" />
		</joined-subclass>
		<joined-subclass name="CategoriaVip" table="CATEGORIA_VIP">
			<key column="ID_CATEGORIA" />
		</joined-subclass>
	</Class>


	<any name="Reproducible" meta-type="string" id-type="long">
		<meta-value value="EPI" class="Episodio" />
		<meta-value value="PELI" class="Pelicula" />
		<column name="REPRODUCIBLE_CLASS" />
		<column name="REPRODUCIBLE_ID" />
	</any>
	
	<class name="Episodio" TABLE="EPISODIO" >
		<id name="oId" column="ID_EPISODIO">
			<generator class="native" />
		</id>
		<property name="duracion" type="long" />
		<property name="numero" type="integer" />
		<property name="titulo" type="string" />
		<many-to-one name="temporada"
			column="ID_TEMPORADA"
			not-null="true"
			cascade="all" />
		
	</class>

	<Class name="Contenido" TABLE="CONTENIDO">
		<id name="oId" column="ID_CONTENIDO">
			<generator class="native" />
		</id>
		<discriminator column="TIPO_CONTENIDO" type="string" />
		<property name="titulo" type="string" column="TITULO" />
		<property name="edadMinima" type="integer" column="EDAD_MINIMA" />
		<subclass name="Pelicula" discriminator-value="pelicula">
			<property name="duracion" type="long" column="DURACION" />

		</subclass>
		<subclass name="Serie" discriminator-value="serie">

			<list name="temporadas" cascade="all">
				<key column="ID_CONTENIDO" not-null="true" />
				<one-to-many class="Temporada" />
			</list>
		</subclass>
	</Class>

	<Class name="Temporada" TABLE="TEMPORADA">
		<id name="oId" column="ID_TEMPORADA">
			<generator class="native" />
		</id>
		<property name="numero" type="integer" />
		<list name="episodios" inverse="true" cascade="all">
			<key column="ID_TEMPORADA" not-null="true" />
			<one-to-many class="Episodio" />
		</list>
	</Class>

</hibernate-mapping>